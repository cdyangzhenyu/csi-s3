apiVersion: v1
kind: PersistentVolume
metadata:
  name: test-bucket
spec:
  accessModes:
  - ReadWriteMany
  capacity:
    storage: 5Gi
  csi:
    controllerPublishSecretRef:
      name: csi-s3-secret
      namespace: kube-system
    driver: ch.ctrox.csi.s3-driver
    fsType: ext4
    nodePublishSecretRef:
      name: csi-s3-secret
      namespace: kube-system
    nodeStageSecretRef:
      name: csi-s3-secret
      namespace: kube-system
    volumeAttributes:
      mounter: s3fs
      bucket: BUCKET
    volumeHandle: test-bucket
  persistentVolumeReclaimPolicy: Delete
  storageClassName: csi-s3
  volumeMode: Filesystem

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-bucket
  namespace: default
spec:
  accessModes:
  - ReadWriteMany
  dataSource: null
  resources:
    requests:
      storage: 5Gi
  storageClassName: csi-s3
  volumeMode: Filesystem
  volumeName: test-bucket

---
apiVersion: v1
kind: Pod
metadata:
  name: csi-s3-test-nginx
  namespace: default
spec:
  containers:
   - name: csi-s3-test-nginx
     image: nginx
     imagePullPolicy: IfNotPresent
     volumeMounts:
       - mountPath: /var/lib/www/html
         name: webroot
  volumes:
   - name: webroot
     persistentVolumeClaim:
       claimName: test-bucket
       readOnly: false